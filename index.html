<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AI Website Builder</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />

  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- FontAwesome CDN -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />

  <style>
    /* Prevent mobile keyboard from covering input */
    body {
      overscroll-behavior: none;
    }
  </style>
</head>

<body class="h-screen w-screen overflow-hidden bg-zinc-800 text-white">
  <!-- APP SHELL -->
  <div class="flex h-full w-full relative">

    <!-- MOBILE OVERLAY -->
    <div id="overlay" class="fixed inset-0 bg-black/50 z-40 hidden md:hidden"></div>

    <!-- SIDEBAR -->
    <aside
      id="sidebar"
      class="fixed md:static inset-y-0 left-0 z-50 w-64 md:w-[250px] bg-[#18181b] flex flex-col transform -translate-x-full md:translate-x-0 transition-transform duration-300"
    >
      <!-- TOP -->
      <div class="p-4 border-b border-zinc-700">
        <button
          id="newProjectBtn"
          class="w-full bg-blue-500 hover:bg-blue-600 text-white py-2 rounded text-sm font-semibold"
        >
          + New Project
        </button>
      </div>

      <!-- MIDDLE (SCROLLABLE PROJECT LIST) -->
      <div
        id="projectList"
        class="flex-1 overflow-y-auto p-2 space-y-1"
      ></div>

      <!-- BOTTOM (SETTINGS FIXED) -->
      <div class="p-3 border-t border-zinc-700">
        <button
          id="settingsBtn"
          class="w-full flex items-center justify-center gap-2 bg-zinc-700 hover:bg-zinc-600 py-2 rounded text-sm"
        >
          <i class="fa-solid fa-gear"></i>
          Settings
        </button>
      </div>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="flex-1 flex flex-col bg-[#27272a] md:ml-[250px]">

      <!-- HEADER -->
      <header class="h-12 flex items-center justify-between px-3 border-b border-zinc-700">
        <div class="flex items-center gap-3">
          <!-- HAMBURGER -->
          <button id="menuBtn" class="md:hidden">
            <i class="fa-solid fa-bars text-lg"></i>
          </button>

          <!-- TRAFFIC LIGHTS -->
          <div class="flex gap-1 ml-2">
            <span class="w-3 h-3 rounded-full bg-red-500"></span>
            <span class="w-3 h-3 rounded-full bg-yellow-400"></span>
            <span class="w-3 h-3 rounded-full bg-green-500"></span>
          </div>
        </div>

        <div class="flex items-center gap-2">
          <button
            id="previewToggle"
            class="px-3 py-1 bg-zinc-700 rounded text-xs"
          >
            Preview
          </button>
          <button
            id="codeToggle"
            class="px-3 py-1 bg-zinc-700 rounded text-xs"
          >
            <i class="fa-solid fa-code"></i>
          </button>
          <button
            id="downloadBtn"
            class="px-3 py-1 bg-blue-500 rounded text-xs"
          >
            <i class="fa-solid fa-download"></i>
          </button>
        </div>
      </header>

      <!-- BODY -->
      <div class="flex-1 relative overflow-hidden">
        <iframe
          id="previewFrame"
          class="absolute inset-0 w-full h-full bg-white"
        ></iframe>

        <textarea
          id="codeEditor"
          class="absolute inset-0 w-full h-full bg-[#1e1e1e] text-white p-4 text-sm font-mono hidden resize-none outline-none"
        ></textarea>
      </div>

      <!-- FOOTER INPUT BAR -->
      <div
        class="fixed md:static bottom-0 left-0 right-0 z-50 bg-[#18181b] border-t border-zinc-700 p-2 flex gap-2"
      >
        <input
          id="promptInput"
          type="text"
          placeholder="Describe the website you want..."
          class="flex-1 bg-zinc-700 rounded px-3 py-2 text-sm outline-none"
        />
        <button
          id="sendBtn"
          class="bg-blue-500 px-4 rounded text-sm font-semibold"
        >
          Generate
        </button>
      </div>
    </main>
  </div>

  <!-- SETTINGS MODAL -->
  <div
    id="settingsModal"
    class="fixed inset-0 z-50 hidden items-center justify-center bg-black/60"
  >
    <div class="bg-[#27272a] w-full max-w-md rounded p-5 space-y-4">
      <h2 class="text-lg font-semibold">Settings</h2>

      <div>
        <label class="text-xs text-zinc-300">OpenRouter API Key</label>
        <input
          id="apiKeyInput"
          type="password"
          class="w-full mt-1 bg-zinc-700 rounded px-3 py-2 text-sm"
        />
      </div>

      <div>
        <label class="text-xs text-zinc-300">Model ID</label>
        <input
          id="modelInput"
          type="text"
          value="deepseek/deepseek-r1:free"
          class="w-full mt-1 bg-zinc-700 rounded px-3 py-2 text-sm"
        />
      </div>

      <div class="flex justify-end gap-2">
        <button
          id="closeSettings"
          class="px-4 py-2 bg-zinc-600 rounded text-sm"
        >
          Cancel
        </button>
        <button
          id="saveSettings"
          class="px-4 py-2 bg-blue-500 rounded text-sm"
        >
          Save
        </button>
      </div>
    </div>
  </div>

  <script>
    /* ================= SYSTEM PROMPT ================= */
    const SYSTEM_PROMPT =
      "You are an expert web developer. Output ONLY raw single-file HTML/CSS/JS code. No markdown. No explanations.";

    /* ================= STATE ================= */
    const state = {
      apiKey: localStorage.getItem("apiKey") || "",
      model: localStorage.getItem("model") || "deepseek/deepseek-r1:free",
      projects: JSON.parse(localStorage.getItem("projects") || "[]"),
      activeProject: null,
    };

    /* ================= ELEMENTS ================= */
    const sidebar = document.getElementById("sidebar");
    const overlay = document.getElementById("overlay");
    const menuBtn = document.getElementById("menuBtn");
    const settingsBtn = document.getElementById("settingsBtn");
    const settingsModal = document.getElementById("settingsModal");
    const closeSettings = document.getElementById("closeSettings");
    const saveSettings = document.getElementById("saveSettings");
    const apiKeyInput = document.getElementById("apiKeyInput");
    const modelInput = document.getElementById("modelInput");

    const previewFrame = document.getElementById("previewFrame");
    const codeEditor = document.getElementById("codeEditor");

    /* ================= SIDEBAR TOGGLE ================= */
    function openSidebar() {
      sidebar.classList.remove("-translate-x-full");
      overlay.classList.remove("hidden");
    }

    function closeSidebar() {
      sidebar.classList.add("-translate-x-full");
      overlay.classList.add("hidden");
    }

    menuBtn.onclick = openSidebar;
    overlay.onclick = closeSidebar;

    /* ================= SETTINGS MODAL ================= */
    settingsBtn.onclick = () => {
      apiKeyInput.value = state.apiKey;
      modelInput.value = state.model;
      settingsModal.classList.remove("hidden");
      settingsModal.classList.add("flex");
    };

    closeSettings.onclick = () => {
      settingsModal.classList.add("hidden");
      settingsModal.classList.remove("flex");
    };

    saveSettings.onclick = () => {
      state.apiKey = apiKeyInput.value.trim();
      state.model = modelInput.value.trim();
      localStorage.setItem("apiKey", state.apiKey);
      localStorage.setItem("model", state.model);
      closeSettings.onclick();
    };

    /* ================= VIEW TOGGLES ================= */
    document.getElementById("previewToggle").onclick = () => {
      previewFrame.classList.remove("hidden");
      codeEditor.classList.add("hidden");
    };

    document.getElementById("codeToggle").onclick = () => {
      codeEditor.classList.remove("hidden");
      previewFrame.classList.add("hidden");
    };

    /* ================= DOWNLOAD ================= */
    document.getElementById("downloadBtn").onclick = () => {
      const blob = new Blob([codeEditor.value], { type: "text/html" });
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "index.html";
      a.click();
    };
  </script>
</body>
</html>
